{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/baran/Documents/baris/mern-social-media/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/baran/Documents/baris/mern-social-media/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/baran/Documents/baris/mern-social-media/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{useDispatch,useSelector}from\"react-redux\";import{getDiscoverPosts,DISCOVER_TYPES}from\"../redux/actions/discoverAction\";import LoadIcon from'../images/loading.gif';import PostThumb from\"../components/PostThumb\";import LoadMoreBtn from'../components/LoadMoreBtn';import{getDataAPI}from'../utils/fetchData';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Discover=function Discover(){var _useSelector=useSelector(function(state){return state;}),auth=_useSelector.auth,discover=_useSelector.discover;var dispatch=useDispatch();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),load=_useState2[0],setLoad=_useState2[1];useEffect(function(){if(!discover.firstLoad){dispatch(getDiscoverPosts(auth.token));}},[dispatch,auth.token,discover.firstLoad]);var handleLoadMore=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoad(true);_context.next=3;return getDataAPI(\"post_discover?num=\".concat(discover.page*8),auth.token);case 3:res=_context.sent;dispatch({type:DISCOVER_TYPES.UPDATE_POSTS,payload:res.data});setLoad(false);case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleLoadMore(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[discover.loading?/*#__PURE__*/_jsx(\"img\",{src:LoadIcon,alt:\"Loading...\",className:\"d-block mx-auto my-4\"}):/*#__PURE__*/_jsx(PostThumb,{posts:discover.posts,result:discover.result}),load&&/*#__PURE__*/_jsx(\"img\",{src:LoadIcon,alt:\"Loading...\",className:\"d-block mx-auto\"}),!discover.loading&&/*#__PURE__*/_jsx(LoadMoreBtn,{result:discover.result,page:discover.page,load:load,handleLoadMore:handleLoadMore})]});};export default Discover;","map":{"version":3,"names":["React","useState","useEffect","useDispatch","useSelector","getDiscoverPosts","DISCOVER_TYPES","LoadIcon","PostThumb","LoadMoreBtn","getDataAPI","Discover","state","auth","discover","dispatch","load","setLoad","firstLoad","token","handleLoadMore","page","res","type","UPDATE_POSTS","payload","data","loading","posts","result"],"sources":["C:/Users/baran/Documents/baris/mern-social-media/client/src/pages/discover.js"],"sourcesContent":["import React, { useState, useEffect} from 'react';\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { getDiscoverPosts, DISCOVER_TYPES } from \"../redux/actions/discoverAction\";\r\nimport LoadIcon from '../images/loading.gif';\r\nimport PostThumb from \"../components/PostThumb\";\r\nimport LoadMoreBtn from '../components/LoadMoreBtn';\r\nimport { getDataAPI } from '../utils/fetchData';\r\n\r\nconst Discover = () => {\r\n    const { auth, discover } = useSelector(state => state);\r\n    const dispatch = useDispatch();\r\n\r\n    const [load, setLoad] = useState(false);\r\n\r\n    useEffect(() => {\r\n      if (!discover.firstLoad) {\r\n        dispatch(getDiscoverPosts(auth.token));\r\n      }\r\n    }, [dispatch, auth.token, discover.firstLoad]);\r\n\r\n    const handleLoadMore = async () => {\r\n        setLoad(true);\r\n        const res = await getDataAPI(`post_discover?num=${discover.page * 8}`, auth.token);\r\n        dispatch({ type: DISCOVER_TYPES.UPDATE_POSTS, payload: res.data });\r\n        setLoad(false);\r\n    };\r\n\r\n    return (\r\n      <div>\r\n        {discover.loading ? (\r\n          <img\r\n            src={LoadIcon}\r\n            alt=\"Loading...\"\r\n            className=\"d-block mx-auto my-4\"\r\n          />\r\n        ) : (\r\n            <PostThumb posts={discover.posts} result={discover.result} />\r\n          \r\n        )}\r\n\r\n        {load && (\r\n          <img src={LoadIcon} alt=\"Loading...\" className=\"d-block mx-auto\" />\r\n        )}\r\n\r\n        {!discover.loading && (\r\n          <LoadMoreBtn\r\n            result={discover.result}\r\n            page={discover.page}\r\n            load={load}\r\n            handleLoadMore={handleLoadMore}\r\n          />\r\n        )}\r\n      </div>\r\n    );\r\n}\r\n\r\nexport default Discover;\r\n"],"mappings":"ubAAA,MAAOA,MAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA0C,OAA1C,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OAASC,gBAAT,CAA2BC,cAA3B,KAAiD,iCAAjD,CACA,MAAOC,SAAP,KAAqB,uBAArB,CACA,MAAOC,UAAP,KAAsB,yBAAtB,CACA,MAAOC,YAAP,KAAwB,2BAAxB,CACA,OAASC,UAAT,KAA2B,oBAA3B,C,wFAEA,GAAMC,SAAQ,CAAG,QAAXA,SAAW,EAAM,CACnB,iBAA2BP,WAAW,CAAC,SAAAQ,KAAK,QAAIA,MAAJ,EAAN,CAAtC,CAAQC,IAAR,cAAQA,IAAR,CAAcC,QAAd,cAAcA,QAAd,CACA,GAAMC,SAAQ,CAAGZ,WAAW,EAA5B,CAEA,cAAwBF,QAAQ,CAAC,KAAD,CAAhC,wCAAOe,IAAP,eAAaC,OAAb,eAEAf,SAAS,CAAC,UAAM,CACd,GAAI,CAACY,QAAQ,CAACI,SAAd,CAAyB,CACvBH,QAAQ,CAACV,gBAAgB,CAACQ,IAAI,CAACM,KAAN,CAAjB,CAAR,CACD,CACF,CAJQ,CAIN,CAACJ,QAAD,CAAWF,IAAI,CAACM,KAAhB,CAAuBL,QAAQ,CAACI,SAAhC,CAJM,CAAT,CAMA,GAAME,eAAc,4FAAG,6IACnBH,OAAO,CAAC,IAAD,CAAP,CADmB,sBAEDP,WAAU,6BAAsBI,QAAQ,CAACO,IAAT,CAAgB,CAAtC,EAA2CR,IAAI,CAACM,KAAhD,CAFT,QAEbG,GAFa,eAGnBP,QAAQ,CAAC,CAAEQ,IAAI,CAAEjB,cAAc,CAACkB,YAAvB,CAAqCC,OAAO,CAAEH,GAAG,CAACI,IAAlD,CAAD,CAAR,CACAT,OAAO,CAAC,KAAD,CAAP,CAJmB,sDAAH,kBAAdG,eAAc,0CAApB,CAOA,mBACE,uBACGN,QAAQ,CAACa,OAAT,cACC,YACE,GAAG,CAAEpB,QADP,CAEE,GAAG,CAAC,YAFN,CAGE,SAAS,CAAC,sBAHZ,EADD,cAOG,KAAC,SAAD,EAAW,KAAK,CAAEO,QAAQ,CAACc,KAA3B,CAAkC,MAAM,CAAEd,QAAQ,CAACe,MAAnD,EARN,CAYGb,IAAI,eACH,YAAK,GAAG,CAAET,QAAV,CAAoB,GAAG,CAAC,YAAxB,CAAqC,SAAS,CAAC,iBAA/C,EAbJ,CAgBG,CAACO,QAAQ,CAACa,OAAV,eACC,KAAC,WAAD,EACE,MAAM,CAAEb,QAAQ,CAACe,MADnB,CAEE,IAAI,CAAEf,QAAQ,CAACO,IAFjB,CAGE,IAAI,CAAEL,IAHR,CAIE,cAAc,CAAEI,cAJlB,EAjBJ,GADF,CA2BH,CA9CD,CAgDA,cAAeT,SAAf"},"metadata":{},"sourceType":"module"}